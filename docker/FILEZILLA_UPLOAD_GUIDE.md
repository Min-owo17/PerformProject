# FileZilla를 사용한 EC2 서버 파일 업로드 가이드

이 가이드는 FileZilla를 사용하여 AWS EC2 서버에 PerformProject 파일을 업로드하는 방법을 단계별로 상세히 안내합니다.

## 📋 목차

1. [FileZilla 설치](#filezilla-설치)
2. [EC2 서버 연결 설정](#ec2-서버-연결-설정)
3. [서버에 연결](#서버에-연결)
4. [프로젝트 파일 업로드](#프로젝트-파일-업로드)
5. [파일 권한 설정](#파일-권한-설정)
6. [문제 해결](#문제-해결)
7. [FileZilla 사용 팁](#filezilla-사용-팁)

---

## FileZilla 설치

### 1. FileZilla 다운로드

1. **공식 웹사이트 접속**
   - https://filezilla-project.org/
   - "Download FileZilla Client" 버튼 클릭

2. **운영체제 선택**
   - Windows, Mac, Linux 중 선택
   - 64비트 버전 다운로드 (권장)

3. **설치 파일 실행**
   - 다운로드한 설치 파일 실행
   - 설치 마법사 따라하기

### 2. FileZilla 실행

- 설치 완료 후 FileZilla 클라이언트 실행
- 처음 실행 시 라이센스 동의 화면 표시

---

## EC2 서버 연결 설정

### 1. 사이트 관리자 열기

**방법 1: 메뉴 사용**
- `파일` → `사이트 관리자` 클릭
- 또는 단축키: `Ctrl+S` (Windows/Linux) 또는 `Cmd+S` (Mac)

**방법 2: 아이콘 사용**
- 상단 툴바의 "사이트 관리자" 아이콘 클릭

### 2. 새 사이트 추가

1. **새 사이트 버튼 클릭**
   - 사이트 관리자 창에서 "새 사이트" 버튼 클릭
   - 또는 `Ctrl+N` (Windows/Linux) 또는 `Cmd+N` (Mac)

2. **사이트 이름 입력**
   - 예: `PerformProject EC2`
   - 또는 `AWS EC2 Server`

### 3. 연결 정보 입력

#### 필수 정보

1. **프로토콜**
   - `SFTP - SSH File Transfer Protocol` 선택
   - 드롭다운 메뉴에서 선택

2. **호스트**
   - EC2 인스턴스의 퍼블릭 IP 주소 또는 퍼블릭 DNS 입력
   - 예시:
     - IP 주소: `54.123.45.67`
     - 퍼블릭 DNS: `ec2-54-123-45-67.ap-northeast-2.compute.amazonaws.com`
   - 퍼블릭 IP 주소는 AWS EC2 콘솔에서 확인 가능

3. **포트**
   - `22` 입력 (기본 SSH 포트)
   - 또는 비어있으면 자동으로 22 사용

4. **로그온 유형**
   - `키 파일` 선택
   - 드롭다운 메뉴에서 선택

5. **사용자**
   - 운영체제에 따라 다름:
     - **Amazon Linux 2**: `ec2-user`
     - **Ubuntu**: `ubuntu`
     - **CentOS**: `centos`
     - **RHEL**: `ec2-user`

6. **키 파일**
   - `.pem` 키 파일 경로 입력
   - "찾아보기" 버튼 클릭하여 키 파일 선택
   - Windows: `C:\path\to\perform-project-key.pem`
   - Mac/Linux: `/path/to/perform-project-key.pem`

#### 선택 정보

1. **비밀번호**
   - 키 파일 사용 시 비워두기
   - 또는 키 파일이 비밀번호로 보호된 경우 입력

2. **주석**
   - 연결에 대한 설명 입력 (선택사항)
   - 예: `PerformProject 프로덕션 서버`

### 4. 연결 설정 저장

1. **연결 테스트**
   - "연결" 버튼 클릭하여 연결 테스트
   - 연결 성공 시 원격 디렉토리 구조 표시

2. **설정 저장**
   - "확인" 버튼 클릭하여 설정 저장
   - 또는 `Esc` 키로 취소

---

## 서버에 연결

### 방법 1: 사이트 관리자에서 연결

1. **사이트 관리자 열기**
   - `파일` → `사이트 관리자` (또는 `Ctrl+S`)

2. **저장한 사이트 선택**
   - 목록에서 저장한 사이트 선택
   - 예: `PerformProject EC2`

3. **연결**
   - "연결" 버튼 클릭
   - 또는 `Enter` 키

### 방법 2: 빠른 연결

1. **빠른 연결 바 사용**
   - 상단의 빠른 연결 바에 정보 입력
   - 호스트, 사용자명, 비밀번호(키 파일 경로), 포트 입력

2. **빠른 연결**
   - "빠른 연결" 버튼 클릭
   - 또는 `Enter` 키

### 연결 확인

연결 성공 시:
- 하단 메시지 로그에 "서버에 연결했습니다" 메시지 표시
- 우측 원격 사이트 영역에 서버의 디렉토리 구조 표시
- 현재 디렉토리: `/home/ec2-user` (Amazon Linux 2) 또는 `/home/ubuntu` (Ubuntu)

연결 실패 시:
- 오류 메시지 확인
- [문제 해결](#문제-해결) 섹션 참조

---

## 프로젝트 파일 업로드

### 1. 로컬 디렉토리 이동

1. **로컬 사이트 영역 확인**
   - 좌측 "로컬 사이트" 영역에서 프로젝트 디렉토리 찾기

2. **프로젝트 디렉토리로 이동**
   - 디렉토리 더블클릭하여 이동
   - 또는 주소창에 경로 직접 입력
   - 예: `C:\Users\YourName\Desktop\개발\PerformProject\PerformProject`

### 2. 서버 디렉토리 생성 및 이동

#### 방법 1: 홈 디렉토리에 업로드 (권장)

1. **홈 디렉토리로 이동**
   - 우측 원격 사이트에서 `/home/ec2-user` (Amazon Linux 2) 또는 `/home/ubuntu` (Ubuntu)로 이동
   - 루트 디렉토리(`/`)에서 시작하여 `home` → `ec2-user` (또는 `ubuntu`) 이동

2. **프로젝트 디렉토리 생성**
   - 우클릭 → "디렉토리 만들기"
   - 디렉토리 이름: `performproject`
   - 또는 `PerformProject`

3. **프로젝트 디렉토리로 이동**
   - 생성한 디렉토리 더블클릭하여 이동

#### 방법 2: /opt 디렉토리에 직접 업로드

**주의**: `/opt` 디렉토리는 루트 권한이 필요하므로, 먼저 SSH로 디렉토리를 생성해야 합니다.

1. **SSH로 서버 접속**
   ```bash
   ssh -i "your-key.pem" ec2-user@your-ec2-ip
   ```

2. **디렉토리 생성**
   ```bash
   sudo mkdir -p /opt/performproject
   sudo chown ec2-user:ec2-user /opt/performproject
   ```

3. **FileZilla에서 /opt로 이동**
   - 우측 원격 사이트에서 루트 디렉토리(`/`)로 이동
   - `opt` 디렉토리로 이동
   - `performproject` 디렉토리로 이동

### 3. 파일 업로드

#### 단일 파일 업로드

1. **파일 선택**
   - 좌측 로컬 사이트에서 업로드할 파일 선택
   - 파일 클릭

2. **업로드**
   - 선택한 파일을 우측 원격 사이트로 드래그 앤 드롭
   - 또는 선택 후 우클릭 → "업로드"
   - 또는 선택 후 상단 툴바의 "업로드" 버튼 클릭 (↑ 아이콘)

#### 여러 파일 업로드

1. **여러 파일 선택**
   - `Ctrl` 키를 누른 채 파일 클릭 (Windows/Linux)
   - `Cmd` 키를 누른 채 파일 클릭 (Mac)
   - 또는 `Shift` 키를 누른 채 첫 번째와 마지막 파일 클릭하여 범위 선택

2. **업로드**
   - 선택한 파일들을 우측 원격 사이트로 드래그 앤 드롭
   - 또는 선택 후 우클릭 → "업로드"

#### 전체 폴더 업로드

1. **폴더 선택**
   - 좌측 로컬 사이트에서 업로드할 폴더 선택
   - 폴더 클릭

2. **업로드**
   - 선택한 폴더를 우측 원격 사이트로 드래그 앤 드롭
   - 또는 선택 후 우클릭 → "업로드"
   - 폴더 내 모든 파일과 하위 폴더가 업로드됨

#### 전체 프로젝트 업로드

1. **프로젝트 루트 디렉토리 선택**
   - 좌측 로컬 사이트에서 프로젝트 루트 디렉토리로 이동
   - 예: `C:\Users\YourName\Desktop\개발\PerformProject\PerformProject`

2. **필요한 폴더/파일만 업로드**
   - `docker` 폴더 업로드
   - `backend` 폴더 업로드 (있는 경우)
   - `frontend` 폴더 업로드 (있는 경우)
   - 기타 필요한 파일 업로드

3. **업로드 제외 항목**
   - `.git` 폴더 (Git 저장소는 별도로 클론)
   - `node_modules` 폴더 (의존성은 서버에서 설치)
   - `.env` 파일 (서버에서 별도 생성)
   - 기타 불필요한 파일

### 4. 업로드 진행 상황 확인

1. **전송된 파일 탭**
   - 하단 "전송된 파일" 탭에서 업로드 진행 상황 확인
   - 전송 속도, 남은 시간, 전송된 바이트 수 표시

2. **업로드 완료 확인**
   - 업로드 완료 후 우측 원격 사이트에서 파일 확인
   - 파일 크기, 수정 날짜 등 확인

### 5. 파일 업로드 후 작업

#### 홈 디렉토리에 업로드한 경우

SSH로 접속하여 `/opt` 디렉토리로 이동:

```bash
# SSH로 접속
ssh -i "your-key.pem" ec2-user@your-ec2-ip

# 디렉토리 이동
sudo mv /home/ec2-user/performproject /opt/performproject
sudo chown -R ec2-user:ec2-user /opt/performproject
```

#### /opt 디렉토리에 직접 업로드한 경우

업로드 완료 후 파일 권한 확인:

```bash
# SSH로 접속
ssh -i "your-key.pem" ec2-user@your-ec2-ip

# 파일 권한 확인
ls -la /opt/performproject
```

---

## 파일 권한 설정

일부 파일(스크립트 등)은 실행 권한이 필요합니다.

### 1. SSH로 서버 접속

```bash
ssh -i "your-key.pem" ec2-user@your-ec2-ip
```

### 2. 프로젝트 디렉토리로 이동

```bash
cd /opt/performproject/docker
```

### 3. 실행 권한 부여

```bash
# 스크립트 파일에 실행 권한 부여
chmod +x setup-env.sh
chmod +x deploy.sh
chmod +x backup.sh
chmod +x restore.sh

# 권한 확인
ls -la *.sh
```

### 4. 파일 소유자 확인

```bash
# 파일 소유자 확인
ls -la

# 소유자 변경 (필요한 경우)
sudo chown -R ec2-user:ec2-user /opt/performproject
```

---

## 문제 해결

### 문제 1: "연결할 수 없습니다" 오류

**증상**:
- FileZilla에서 "연결할 수 없습니다" 오류 메시지 표시
- 연결 시도 실패

**원인**:
1. 잘못된 호스트 주소
2. 보안 그룹에서 SSH(22) 포트가 차단됨
3. 키 파일 경로 오류
4. EC2 인스턴스가 실행되지 않음

**해결 방법**:

1. **EC2 인스턴스 퍼블릭 IP 주소 확인**
   - AWS EC2 콘솔에서 인스턴스 선택
   - "퍼블릭 IPv4 주소" 확인
   - FileZilla의 호스트에 정확한 IP 주소 입력

2. **보안 그룹 확인**
   - EC2 콘솔에서 인스턴스 선택
   - "보안" 탭에서 보안 그룹 확인
   - 인바운드 규칙에서 SSH(22) 포트가 열려있는지 확인
   - 소스가 "내 IP" 또는 "0.0.0.0/0"인지 확인

3. **키 파일 경로 확인**
   - 키 파일이 존재하는지 확인
   - 키 파일 경로가 정확한지 확인
   - Windows: 절대 경로 사용 (예: `C:\Users\YourName\Downloads\key.pem`)
   - Mac/Linux: 절대 경로 또는 상대 경로 사용

4. **EC2 인스턴스 상태 확인**
   - EC2 콘솔에서 인스턴스 상태 확인
   - "실행 중" 상태인지 확인
   - 인스턴스가 중지된 경우 시작

### 문제 2: "인증 실패" 오류

**증상**:
- FileZilla에서 "인증 실패" 오류 메시지 표시
- 연결 시도 실패

**원인**:
1. 잘못된 사용자명
2. 키 파일 형식 오류
3. 키 파일이 올바르지 않음
4. 키 파일 권한 문제 (Mac/Linux)

**해결 방법**:

1. **사용자명 확인**
   - Amazon Linux 2: `ec2-user`
   - Ubuntu: `ubuntu`
   - CentOS: `centos`
   - RHEL: `ec2-user`
   - FileZilla의 사용자명에 정확한 사용자명 입력

2. **키 파일 확인**
   - 키 파일이 올바른지 확인
   - 키 파일이 손상되지 않았는지 확인
   - AWS EC2 콘솔에서 키 페어 다시 다운로드

3. **키 파일 권한 확인 (Mac/Linux)**
   ```bash
   # 키 파일 권한 확인
   ls -la your-key.pem
   
   # 키 파일 권한 변경
   chmod 400 your-key.pem
   ```

4. **키 파일 형식 확인**
   - 키 파일이 `.pem` 형식인지 확인
   - 키 파일이 텍스트 형식인지 확인 (바이너리가 아님)

### 문제 3: "/opt 디렉토리에 접근할 수 없습니다" 오류

**증상**:
- FileZilla에서 `/opt` 디렉토리로 이동할 수 없음
- "권한이 거부되었습니다" 오류 메시지 표시

**원인**:
- `/opt` 디렉토리는 루트 권한이 필요
- 일반 사용자는 `/opt` 디렉토리에 접근할 수 없음

**해결 방법**:

1. **방법 1: 홈 디렉토리에 업로드 후 이동 (권장)**
   ```bash
   # FileZilla로 /home/ec2-user/performproject에 업로드
   # SSH로 접속하여 이동
   ssh -i "your-key.pem" ec2-user@your-ec2-ip
   sudo mv /home/ec2-user/performproject /opt/performproject
   sudo chown -R ec2-user:ec2-user /opt/performproject
   ```

2. **방법 2: SSH로 디렉토리 생성 후 업로드**
   ```bash
   # SSH로 접속
   ssh -i "your-key.pem" ec2-user@your-ec2-ip
   
   # 디렉토리 생성
   sudo mkdir -p /opt/performproject
   sudo chown ec2-user:ec2-user /opt/performproject
   ```
   - 그 후 FileZilla로 `/opt/performproject`에 업로드

3. **방법 3: sudo 권한으로 파일 업로드**
   - FileZilla에서는 직접 불가능
   - 홈 디렉토리에 업로드 후 SSH로 이동하는 방법 사용

### 문제 4: 대용량 파일 업로드 실패

**증상**:
- 대용량 파일 업로드 중 연결 끊김
- 업로드 실패

**원인**:
1. 네트워크 연결 불안정
2. 타임아웃 설정
3. 파일 크기 제한

**해결 방법**:

1. **타임아웃 시간 증가**
   - FileZilla 메뉴: `편집` → `설정` → `연결`
   - "타임아웃(초)" 값을 증가 (예: 60 → 120)
   - "확인" 버튼 클릭

2. **재시도 횟수 증가**
   - FileZilla 메뉴: `편집` → `설정` → `전송`
   - "재시도 횟수" 값을 증가 (예: 2 → 5)
   - "확인" 버튼 클릭

3. **대용량 파일 압축 후 업로드**
   ```bash
   # 로컬에서 압축
   tar -czf performproject.tar.gz performproject/
   
   # FileZilla로 압축 파일 업로드
   # SSH로 접속하여 압축 해제
   ssh -i "your-key.pem" ec2-user@your-ec2-ip
   cd /opt/performproject
   tar -xzf performproject.tar.gz
   ```

4. **동시 전송 수 감소**
   - FileZilla 메뉴: `편집` → `설정` → `전송`
   - "동시 전송 수" 값을 감소 (예: 2 → 1)
   - "확인" 버튼 클릭

### 문제 5: 파일 업로드 속도가 느림

**증상**:
- 파일 업로드 속도가 매우 느림
- 전송 속도가 불안정

**해결 방법**:

1. **전송 속도 제한 해제**
   - FileZilla 메뉴: `편집` → `설정` → `전송`
   - "속도 제한" 체크 해제
   - "확인" 버튼 클릭

2. **동시 전송 수 증가**
   - FileZilla 메뉴: `편집` → `설정` → `전송`
   - "동시 전송 수" 값을 증가 (예: 2 → 4)
   - "확인" 버튼 클릭

3. **네트워크 연결 확인**
   - 인터넷 연결 상태 확인
   - 다른 네트워크로 변경 시도
   - VPN 사용 중인 경우 해제 후 시도

### 문제 6: 파일 이름 인코딩 문제

**증상**:
- 한글 파일명이 깨져서 표시됨
- 파일 업로드 후 파일명이 변경됨

**해결 방법**:

1. **파일 이름 인코딩 설정**
   - FileZilla 메뉴: `편집` → `설정` → `전송`
   - "파일 이름 인코딩" 설정
   - "UTF-8" 선택
   - "확인" 버튼 클릭

2. **파일명 변경**
   - 한글 파일명을 영문으로 변경
   - 또는 파일명에 특수문자 제거

---

## FileZilla 사용 팁

### 1. 빠른 연결 저장

- 연결 성공 후 `파일` → `사이트 관리자`에서 저장
- 다음부터는 사이트 관리자에서 바로 연결 가능
- 여러 서버를 관리하는 경우 각각 저장

### 2. 동기화된 탐색

- `보기` → `동기화된 탐색` 활성화
- 로컬과 원격 디렉토리를 동기화하여 탐색
- 한쪽에서 디렉토리를 변경하면 다른 쪽도 자동으로 변경

### 3. 파일 비교

- `서버` → `파일 비교`로 로컬과 원격 파일 비교
- 변경된 파일만 업로드 가능
- 파일 크기, 수정 날짜 등으로 비교

### 4. 원격 파일 편집

- 원격 파일을 더블클릭하여 로컬에서 편집
- 저장 시 자동으로 서버에 업로드
- `편집` → `설정` → `파일 편집`에서 편집기 설정

### 5. 전송 큐 관리

- 여러 파일을 선택하여 큐에 추가
- 전송 큐에서 업로드 순서 조정
- 전송 큐에서 특정 파일 제거 가능

### 6. 북마크 기능

- 자주 사용하는 디렉토리를 북마크로 저장
- 빠르게 접근 가능
- `책갈피` → `책갈피 추가` 메뉴 사용

### 7. 필터 기능

- 특정 파일만 표시하도록 필터 설정
- `보기` → `필터` 메뉴 사용
- 파일 확장자, 파일명 패턴 등으로 필터링

### 8. 로그 파일 확인

- `파일` → `로그 보기`로 전송 로그 확인
- 오류 메시지 확인
- 전송 이력 확인

---

## 추가 리소스

- [FileZilla 공식 문서](https://wiki.filezilla-project.org/)
- [FileZilla 포럼](https://forum.filezilla-project.org/)
- [AWS EC2 문서](https://docs.aws.amazon.com/ec2/)

---

## 지원

문제가 발생하면 다음을 확인하세요:
1. FileZilla 로그 확인
2. EC2 인스턴스 상태 확인
3. 보안 그룹 설정 확인
4. 키 파일 확인

추가 도움이 필요하면 프로젝트 이슈를 생성하세요.

